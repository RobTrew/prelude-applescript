{
  "title": "subsequences",
  "cells": [
    {
      "type": "code",
      "language": "applescript",
      "data": "-- subsequences([1,2,3]) -> [[],[1],[2],[1,2],[3],[1,3],[2,3],[1,2,3]]\n-- subsequences(\"abc\") -> [\"\",\"a\",\"b\",\"ab\",\"c\",\"ac\",\"bc\",\"abc\"]"
    },
    {
      "type": "code",
      "language": "applescript",
      "data": "-- subsequences :: [a] -> [[a]]\n-- subsequences :: String -> [String]\non subsequences(xs)\n    script nonEmptySubsequences\n        on |λ|(xxs)\n            if length of xxs < 1 then\n                {}\n            else\n                set {x, xs} to {item 1 of xxs, tail(xxs)}\n        \n                script f\n                    on |λ|(ys, r)\n                        cons(ys, cons(cons(x, ys), r))\n                    end |λ|\n                end script\n                \n                cons({x}, foldr(f, {}, |λ|(xs) of nonEmptySubsequences))\n            end if\n        end |λ|\n    end script\n    if class of xs is text then\n        cons(\"\", map(my concat, |λ|(characters of xs) of nonEmptySubsequences))\n    else\n        cons([], |λ|(xs) of nonEmptySubsequences)\n    end if\nend subsequences"
    }
  ]
}