{
  "title": "matching",
  "cells": [
    {
      "type": "code",
      "language": "applescript",
      "data": "-- Returns a sequence-matching function for findIndices etc"
    },
    {
      "type": "code",
      "language": "applescript",
      "data": "-- matching :: [a] -> (a -> Int -> [a] -> Bool)\n-- matching :: String -> (Char -> Int -> String -> Bool)\non matching(pat)\n    if class of pat is text then\n        set xs to characters of pat\n    else\n        set xs to pat\n    end if\n    set lng to length of xs\n    set bln to 0 < lng\n    if bln then\n        set h to item 1 of xs\n    else\n        set h to missing value\n    end if\n    script\n        on |λ|(x, i, src)\n            (h = x) and xs = ¬\n                (items i thru min(length of src, -1 + lng + i) of src)\n        end |λ|\n    end script\nend matching"
    }
  ]
}