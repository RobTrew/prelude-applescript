{
  "title": "groupBy",
  "cells": [
    {
      "type": "code",
      "language": "applescript",
      "data": "-- Typical usage: groupBy(on(eq, f), xs)"
    },
    {
      "type": "code",
      "language": "applescript",
      "data": "-- groupBy :: (a -> a -> Bool) -> [a] -> [[a]]\non groupBy(f, xs)\n    set mf to mReturn(f)\n    \n    script enGroup\n        on |λ|(a, x)\n            if length of (active of a) > 0 then\n                set h to item 1 of active of a\n            else\n                set h to missing value\n            end if\n            \n            if h is not missing value and mf's |λ|(h, x) then\n                {active:(active of a) & {x}, sofar:sofar of a}\n            else\n                {active:{x}, sofar:(sofar of a) & {active of a}}\n            end if\n        end |λ|\n    end script\n    \n    if length of xs > 0 then\n        set dct to foldl(enGroup, {active:{item 1 of xs}, sofar:{}}, rest of xs)\n        if length of (active of dct) > 0 then\n            sofar of dct & {active of dct}\n        else\n            sofar of dct\n        end if\n    else\n        {}\n    end if\nend groupBy"
    }
  ]
}