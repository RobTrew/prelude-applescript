{
  "title": "replicateM",
  "cells": [
    {
      "type": "code",
      "language": "applescript",
      "data": "-- Instance for lists only here\n\n-- e.g. replicateM(3, {1, 2})) -> \n-- {{1, 1, 1}, {1, 1, 2}, {1, 2, 1}, {1, 2, 2}, {2, 1, 1}, \n--  {2, 1, 2}, {2, 2, 1}, {2, 2, 2}}"
    },
    {
      "type": "code",
      "language": "applescript",
      "data": "-- replicateM :: Int -> [a] -> [[a]]\non replicateM(n, xs)\n    script go\n        script cons\n            on |λ|(a, bs)\n                {a} & bs\n            end |λ|\n        end script\n        on |λ|(x)\n            if x ≤ 0 then\n                {{}}\n            else\n                liftA2List(cons, xs, |λ|(x - 1))\n            end if\n        end |λ|\n    end script\n    \n    go's |λ|(n)\nend replicateM"
    }
  ]
}