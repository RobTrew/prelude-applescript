{
  "title": "splitBy",
  "cells": [
    {
      "type": "code",
      "language": "applescript",
      "data": "-- splitBy :: (a -> a -> Bool) -> [a] -> [[a]]\n-- splitBy :: (String -> String -> Bool) -> String -> [String]\non splitBy(p, xs)\n    if length of xs < 2 then\n        {xs}\n    else\n        script f\n            property mp : |λ| of mReturn(p)\n            on |λ|(a, x)\n                set {acc, active, prev} to a\n                if mp(prev, x) then\n                    {acc & {active}, {x}, x}\n                else\n                    {acc, active & x, x}\n                end if\n            end |λ|\n        end script\n        \n        set h to item 1 of xs\n        set lstParts to foldl(f, {{}, {h}, h}, items 2 thru -1 of xs)\n        if class of item 1 of xs = string then\n            map(concat, (item 1 of lstParts & {item 2 of lstParts}))\n        else\n            item 1 of lstParts & {item 2 of lstParts}\n        end if\n    end if\nend splitBy"
    }
  ]
}