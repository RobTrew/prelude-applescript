{
  "title": "treeMenu",
  "cells": [
    {
      "type": "code",
      "language": "applescript",
      "data": "-- treeMenu :: Tree String -> IO [String]\non treeMenu(tree)\n    script go\n        on |λ|(tree)\n            set menuTitle to root of tree\n            set subTrees to nest of tree\n            set menuItems to map(my root, subTrees)\n            set blnNoSubMenus to {} = concatMap(my nest, subTrees)\n            \n            script menuCancelledOrChoiceMade\n                on |λ|(statusAndChoices)\n                    (not my fst(statusAndChoices)) or ({} ≠ my snd(statusAndChoices))\n                end |λ|\n            end script\n            \n            script choicesOrSubMenu\n                on |λ|(choices)\n                    set k to item 1 of choices\n                    script match\n                        on |λ|(x)\n                            k = root of x\n                        end |λ|\n                    end script\n                    set chosenSubTree to (Just of find(match, subTrees))\n                    if {} ≠ (nest of chosenSubTree) then\n                        |Right|(|λ|(chosenSubTree) of go)\n                    else\n                        |Right|(choices)\n                    end if\n                end |λ|\n            end script\n            \n            script nothingFromThisMenu\n                on |λ|(_)\n                    Tuple(false, {})\n                end |λ|\n            end script\n            \n            script selectionsFromThisMenu\n                on |λ|(xs)\n                    Tuple(true, xs)\n                end |λ|\n            end script\n            \n            script nextStepInNestedMenu\n                on |λ|(statusAndChoice)\n                    either(nothingFromThisMenu, selectionsFromThisMenu, ¬\n                        bindLR(showMenuLR(blnNoSubMenus, menuTitle, menuItems), ¬\n                            choicesOrSubMenu))\n                end |λ|\n            end script\n            \n            snd(|until|(menuCancelledOrChoiceMade, ¬\n                nextStepInNestedMenu, ¬\n                Tuple(true, {}))) -- (Status, Choices) pair\n        end |λ|\n    end script\n    |λ|(tree) of go\nend treeMenu"
    }
  ]
}