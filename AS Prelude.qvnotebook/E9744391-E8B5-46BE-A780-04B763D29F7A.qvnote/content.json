{
  "title": "findTree",
  "cells": [
    {
      "type": "code",
      "language": "applescript",
      "data": "-- The first of any nodes in the tree which match the predicate p\n-- (For all matches, see treeMatches)"
    },
    {
      "type": "code",
      "language": "applescript",
      "data": "-- findTree :: (a -> Bool) -> Tree a -> Maybe Tree a\non findTree(p, tree)\n    script go\n        property pf : mReturn(p)'s |λ|\n        on |λ|(oNode)\n            if pf(root of oNode) then\n                Just(oNode)\n            else\n                set xs to nest of oNode\n                set lng to length of xs\n                \n                script inNest\n                    on |λ|(tpl)\n                        lng < fst(tpl) or (not (Nothing of snd(tpl)))\n                    end |λ|\n                end script\n                \n                script nextPeer\n                    on |λ|(tpl)\n                        Tuple(1 + fst(tpl), go's |λ|(item (fst(tpl)) of xs))\n                    end |λ|\n                end script\n                \n                if 0 < lng then\n                    snd(|until|(inNest, nextPeer, Tuple(1, Nothing())))\n                else\n                    Nothing()\n                end if\n            end if\n        end |λ|\n    end script\n    \n    go's |λ|(tree)\nend findTree"
    }
  ]
}