{
  "title": "mapMaybeGen",
  "cells": [
    {
      "type": "code",
      "language": "applescript",
      "data": "-- mapMaybeGen :: (a -> Maybe b) -> Gen [a] -> Gen [b]\non mapMaybeGen(mf, gen)\n    script\n        property mg : mReturn(mf)\n        on |λ|()\n            set v to gen's |λ|()\n            if v is not missing value then\n                set mb to mg's |λ|(v)\n                repeat while (Nothing of mb) and not (missing value is v)\n                    set v to gen's |λ|()\n                    if missing value is not v then set mb to mg's |λ|(v)\n                end repeat\n                if not |Nothing| of mb then\n                    |Just| of mb\n                else\n                    missing value\n                end if\n            else\n                v\n            end if\n        end |λ|\n    end script\nend mapMaybeGen"
    }
  ]
}